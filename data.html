<!DOCTYPE html>
<!--  This site was created in Webflow. http://www.webflow.com  -->
<!--  Last Published: Fri Apr 05 2019 06:48:22 GMT+0000 (UTC)  -->
<html data-wf-page="5ca6819e0b55ef9a4142a530" data-wf-site="5ca661b61ef2f2aeb5cc4c6b">
<head>
  <meta charset="utf-8">
  <title>Data</title>
  <meta content="Data" property="og:title">
  <meta content="width=device-width, initial-scale=1" name="viewport">
  <meta content="Webflow" name="generator">
  <link href="css/normalize.css" rel="stylesheet" type="text/css">
  <link href="css/webflow.css" rel="stylesheet" type="text/css">
  <link href="css/wangs-first-project-256e08.webflow.css" rel="stylesheet" type="text/css">
  <link href="css/sidebar.css" rel="stylesheet" type="text/css">

    <link rel="stylesheet" href="lib/ol.css" type="text/css">
    <!-- The line below is only needed for old environments like Internet Explorer and Android 4.x -->
    <script src="https://cdn.polyfill.io/v2/polyfill.min.js?features=requestAnimationFrame,Element.prototype.classList,URL"></script>
    <script src="lib/ol.js"></script>

    <!--  <link href="lib/leaflet/leaflet.css" rel="stylesheet" />-->

    <link href="lib/bootstrap/css/bootstrap.min.css" rel="stylesheet" />
<!--    <link href="lib/L.Control.ZoomDisplay.css" rel="stylesheet" />-->
    <link rel="stylesheet" href="css/site.css" />
<!--    <link href="lib/leaflet.fullscreen.css" rel="stylesheet" />-->
    <!--<link href="lib/jquery-ui.css" rel="stylesheet" />-->
    <link href="lib/L.Control.MousePosition.css" rel="stylesheet" />
    <link rel=icon href=favicon.png sizes="any" type="image/png">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-select@1.13.10/dist/css/bootstrap-select.min.css">
    <link rel="stylesheet" type="text/css" href="lib/snackbar/snackbar.min.css" />
    <script type="text/javascript" src="lib/snackbar/snackbar.min.js"></script>


  <script src="https://ajax.googleapis.com/ajax/libs/webfont/1.4.7/webfont.js" type="text/javascript"></script>
  <script type="text/javascript">WebFont.load({  google: {    families: ["Montserrat:100,100italic,200,200italic,300,300italic,400,400italic,500,500italic,600,600italic,700,700italic,800,800italic,900,900italic","Lato:100,100italic,300,300italic,400,400italic,700,700italic,900,900italic"]  }});</script>
  <!-- [if lt IE 9]><script src="https://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv.min.js" type="text/javascript"></script><![endif] -->
  <script type="text/javascript">!function(o,c){var n=c.documentElement,t=" w-mod-";n.className+=t+"js",("ontouchstart"in o||o.DocumentTouch&&c instanceof DocumentTouch)&&(n.className+=t+"touch")}(window,document);</script>
  <link href="https://daks2k3a4ib2z.cloudfront.net/img/favicon.ico" rel="shortcut icon" type="image/x-icon">
  <link href="https://daks2k3a4ib2z.cloudfront.net/img/webclip.png" rel="apple-touch-icon">
</head>
<body class="body-3">
  <div data-collapse="medium" data-animation="default" data-duration="400" class="navigation w-nav">
    <div class="navigation-items"><a href="index.html" class="logo-link w-nav-brand"><img src="images/white_logo.svg" width="148" data-w-id="4990a16e-0ffe-6b5d-24e6-cb04cd55b9f2" alt="" class="logo-image"></a>
      <div class="navigation-wrap">
        <nav id="top_nav" role="navigation" class="navigation-items w-nav-menu">
            <a href="index.html" data-w-id="7a0fcfca-4366-6300-f19e-a21a3ae03d33" class="navigation-item w-nav-link">HOME</a>
            <a href="data.html" data-w-id="4990a16e-0ffe-6b5d-24e6-cb04cd55b9f5" class="navigation-item w-nav-link w--current">DATA</a>
            <a href="about.html" data-w-id="4990a16e-0ffe-6b5d-24e6-cb04cd55b9f7" class="navigation-item w-nav-link">ABOUT</a>
            <a href="team.html" data-w-id="4990a16e-0ffe-6b5d-24e6-cb04cd55b9f9" class="navigation-item w-nav-link">TEAM</a>
            <a href="data_login.html" id="login_nav" data-w-id="4990a16e-0ffe-6b5d-24e6-cb04cd55b9f9" class="navigation-item w-nav-link">LOG IN</a>
            <a id="user_nav" data-w-id="4990a16e-0ffe-6b5d-24e6-cb04cd55b9f9" class="navigation-item w-nav-link" style="display:none"></a>
        </nav>


        <div class="menu-button w-nav-button"><img src="images/menu-icon_1menu-icon.png" width="22" alt="" class="menu-icon"></div>
      </div>
    </div>
  </div>
  <div class="section-4">
    <div class="w-container">
        <div id="mySidebar" class="sidebar">
            <img src="images/refresh_icon.png" class="closebtn" style="left:5px" width="20" alt="download"/><a onclick="refreshQueue()" href="javascript:void(0)" class="closebtn" style="left:5px">Refresh</a>
            <a href="javascript:void(0)" class="closebtn" onclick="closeNav()">X Close</a>
            <ul class="list-group list-group-flush" style="margin-top:50px">
                <li class="list-group-item list-group-item-action flex-column align-items-star">
                     <div class="d-flex w-100 justify-content-between">
                         <h5 class="mb-1"><b>Query:</b> 2021/03/22 09:34:42</h5>
                     </div>
                    <p class="mb-1" id="query-status"><b>Status:</b> pending </p>
                    <small><a style="display: none" >download</a></small>
                </li>

            </ul>
        </div>

        <div id="main">
          <button class="openbtn btn-primary" onclick="openNav()">Queries
<!--              <img src="images/download_icon.png" width="35" alt="download"/>-->
              <span id="badge" class="badge badge-pill badge-warning" style="display: none">0</span></button>
        </div>

      <h1 data-w-id="ecbd41cd-5b2d-78be-ec94-d855601f6275" style="-webkit-transform:translate3d(0, 22PX, 0) scale3d(1, 1, 1) rotateX(0) rotateY(0) rotateZ(0) skew(0, 0);-moz-transform:translate3d(0, 22PX, 0) scale3d(1, 1, 1) rotateX(0) rotateY(0) rotateZ(0) skew(0, 0);-ms-transform:translate3d(0, 22PX, 0) scale3d(1, 1, 1) rotateX(0) rotateY(0) rotateZ(0) skew(0, 0);transform:translate3d(0, 22PX, 0) scale3d(1, 1, 1) rotateX(0) rotateY(0) rotateZ(0) skew(0, 0);opacity:0" class="heading">DATA</h1>
      <div data-w-id="ecbd41cd-5b2d-78be-ec94-d855601f6277" style="-webkit-transform:translate3d(0, 22PX, 0) scale3d(1, 1, 1) rotateX(0) rotateY(0) rotateZ(0) skew(0, 0);-moz-transform:translate3d(0, 22PX, 0) scale3d(1, 1, 1) rotateX(0) rotateY(0) rotateZ(0) skew(0, 0);-ms-transform:translate3d(0, 22PX, 0) scale3d(1, 1, 1) rotateX(0) rotateY(0) rotateZ(0) skew(0, 0);transform:translate3d(0, 22PX, 0) scale3d(1, 1, 1) rotateX(0) rotateY(0) rotateZ(0) skew(0, 0);opacity:0" class="paragraph-bigger cc-bigger-light">
	  
	  <div class="description">
		<p>This page allow you download the HydroClim datasets, providing monthly streamflow and water temperature predictions for stream sections in all major watersheds across the United States from 1950-2099. </p>
		<p>You can also check our data visualization map <a href="map.html">here</a>.</p></div>
<form id="submitform">
  <div class="panel-group" id="accordion">
  <div class="panel panel-default">
    <div class="panel-heading">
      <h4 class="panel-title">
        <a class="accordion-toggle" data-toggle="collapse" data-parent="#accordion" href="#collapseOne">
          Step 1: Date and Basin Selection
        </a>
      </h4>
    </div>
      <div id="hydroclim-result1">
		<div id="date-result"></div>
		<h4 class="warning" id="warning-date-r">--The start date should be before the end date.--</h4> 
		<div id="basin-result">
		</div>
		<h4 class="warning" id="warning-basin-r">--Please select at least one basin.--</h4>
	</div>
    <div id="collapseOne" class="panel-collapse collapse in">
      <div class="panel-body">
           <div class="hydroclim-data-collapse" id="first-part">
                <!-- Data Selection -->
            <div>
                 <div class="description">
                    <p class="sub-description">Please select a range of years and months and at least one basin. </p>
                 </div>
                <h3>Date Selection</h3> <h3 class="warning" id="warning-date">--The start date should be before the end date.--</h3>
                <div class="hydroclim-date-panel" id="hydroclim-date-panel-subset" >
                    <div style="display:inline-block">
                        <h4>
                            <input id="timesub" type="radio" name="hydroclim-date" checked/> Subset <span style="color: #6aa6e3;" class="glyphicon glyphicon-question-sign" data-toggle="tooltip" title="Only specified months in the specified years. Example: Year Selection:1950 to 1955; Month Selection: January to August: January to August (eight months) from 1950 to 1955 (total of 40 months) "></span>
                        &nbsp;&nbsp;&nbsp;
                            <input id="timefull" type="radio" name="hydroclim-date" /> Full <span style="color: #6aa6e3;" class="glyphicon glyphicon-question-sign" data-toggle="tooltip" title="All months from starting month and year through ending month and year. Example: Year Selection:1950 to 1955; Month Selection: January to August: January 1950 through August 1955 (total of 56 months)"></span>
						 </h4>
						 <div class="hydroclim-data-options-end-selector">
                            <div>
                                <label class="hydroclim-data-options-label" for="hydroclim-data-date-selector">Year Selection</label>
                                 <label class="dropdown-label">From:&nbsp;</label>
                                        <select class="selectpicker date-selection" id="yearstart" name="yearstart"></select>
                                 <label class="dropdown-label">To:&nbsp;</label>
                                        <select class="selectpicker date-selection" id="yearend" name="yearend"></select>

                            </div>
                        </div>
                        <div class="hydroclim-data-options-start-selector">
                            <label class="hydroclim-data-options-label" for="hydroclim-data-date-selector">Month Selection</label>
                             <label class="dropdown-label">From:&nbsp;</label>
                            <select class="selectpicker date-selection"  id="monthstart" name="monthstart"></select>

                             <label class="dropdown-label">To:&nbsp;</label>
                                        <select class="selectpicker date-selection"  id="monthend" name="monthend"></select>
                        </div>

                       
                    </div>
            </div>
            <!-- Basin Selection -->
            <div>
                <h3>Basin Selection</h3> <h3 class="warning" id="warning-basin">--Please select at least one basin.--</h3>
                <div class="description">
                    <p class="sub-description">Please select/deselect one basin from the dropdown list.</p>
                 </div>
<!--                <select form="submitform" name="basin_id" id="basin-data" data-width="auto" class="selectpicker" multiple data-actions-box="true" multiple title="Choose one or more basins of the following...">-->
<!--                </select>-->
                <select form="submitform" name="basin_id" id="basin-data" data-width="auto" class="selectpicker" data-actions-box="true" title="Choose one basin of the following...">
                </select>

            </div>

                <div class="map-child">
                    <div id="basin-map">

                    </div>

                </div>
            </div>
      </div>
    </div>
  </div>
  <div class="panel panel-default">
    <div class="panel-heading">
      <h4 class="panel-title">
        <a class="accordion-toggle" data-toggle="collapse" data-parent="#accordion" href="#collapseTwo">
          Step 2. Model Selection
        </a>
      </h4>
    </div>
       <div id="hydroclim-result2"> 
			<div id="model-result"></div>
			<h4 class="warning" id="warning-model-r">--Please select historical data or at least one RCP model data.--</h4> 
			<div id="rcp-result"></div>
			<h4 class="warning" id="warning-rcp-r">--Please select at least one RCP model data.--</h4> 
		</div>
    <div id="collapseTwo" class="panel-collapse collapse">
      <div class="panel-body">
          <!-- Data Type selection: Observed, RCP4.5, RCP 8.5-->
           <div class="description">
               <p class="sub-description">Please choose Historical Data and/or at least one RCP model.
               </p>
           </div>
            <div>
                <h3>Historical Data</h3>
                <div class="description">
                    <p class="sub-description" style="color: #cd6666">Reminder:To obtain Historical Data the date range must include years and months prior to 1999.
                    </p>
                </div>
				<h3 class="warning" id="warning-model">--Please select historical data or at least one RCP model data.--</h3>
                <div class="col-md-12">
					<h4><input id='obs-r' name="isobserved" type="checkbox" /> Historical Data (1950 - 1999)</h4>
				</div>
                <!--<table id="historical-data" border='1'>
                    <tr>
                        <th>Select</th>
                        <th>Name</th>
                        <th>Description</th>
                        <th>Country</th>
                    </tr>
                    <tr>
                        <td style="padding: 1px;">
                            <input type="checkbox" />
                        </td>
                        <td style="padding: 1px;">
                            Historical
                        </td>
                        <td style="padding: 1px;">
                            1950-1999
                        </td>
                        <td style="padding: 1px;">
                            --
                        </td>
                    </tr>
                </table>-->
            </div>
          <div>

              <h3><span style=" border-bottom: 1px dashed #000;" data-toggle="tooltip" data-placement="right" title="Representative Concentration Pathway">RCP</span> </h3>
               <div class="description">
                    <p class="sub-description">Please specify one or more climate models for RCP.
                    </p>
               </div>
              <h4 class="warning" id="warning-rcp">--Please select at least one RCP model data.--</h4>
            <div class="col-md-6">

                <h4><input id="45-r" type="checkbox" name="hydroclim-rcp-models"/>RCP 4.5 (1950 - 2099)</h4>
                    <select disabled id="45-data" name="45-data" class="selectpicker"  multiple data-actions-box="true" multiple title="Choose one or more models of the following...">

                    </select>

            </div>
            <div class="col-md-6">
                <h4><input id="85-r" type="checkbox" name="hydroclim-rcp-models"/>RCP 8.5 (1950 - 2099)</h4>
                 <select disabled id="85-data" name="85-data" class="selectpicker"  multiple data-actions-box="true" multiple title="Choose one or more models of the following...">

                    </select>
            </div>
          </div>
      </div>
    </div>
  </div>
  <div class="panel panel-default">
    <div class="panel-heading">
      <h4 class="panel-title">
        <a class="accordion-toggle" data-toggle="collapse" data-parent="#accordion" href="#collapseThree">
         Step 3. Statistics
        </a>
      </h4>
    </div>
       <div id="hydroclim-result3">
           <div id="raw-result"></div>
			<h4 class="warning" id="warning-raw">--Please select original data or at least one statistics data.--</h4>
			<div id="stats-result"></div>
			<h4 class="warning" id="warning-stats">--Please select at least one statistics option.--</h4>
       </div>
    <div id="collapseThree" class="panel-collapse collapse">
      <div class="panel-body">
          <div class="description">
               <p class="sub-description">Please choose raw water temperature and/or discharge data or any of the statistical summaries of these data listed below.
               </p>
           </div>
          <h4 class="warning" id="warning-raw-r">--Please select original data or at least one statistics data.--</h4>
          <h4><input type="checkbox" name="hydroclim-stasticis" id="hydroclim-stast-orig"/>Water Temperature(&#8451;) and Discharge(m<sup>3</sup>/s) raw data</h4>
          <h4 class="warning" id="warning-stats-r">--Please select at least one statistics option.--</h4>
         <h4>  <input type="checkbox" name="hydroclim-stasticis" id="hydroclim-stast"/>  Statistics of Water Temperature(&#8451;) and Discharge(m<sup>3</sup>/s) data</h4>
                <span><div id="stast-group" class="col-md-6">
                <h4><input id="avg" type="checkbox" name="hydroclim-stas" disabled value="Average "/> Average</h4>
                <h4><input id="max" type="checkbox" name="hydroclim-stas" disabled value="Max "/> Max </h4>
                <h4><input id="min" type="checkbox" name="hydroclim-stas" disabled value="Min "/> Min </h4>
                <h4><input id="sd" type="checkbox" name="hydroclim-stas" disabled  value="Standard Deviation "/> Standard Deviation </h4>
                <h4><input id="va" type="checkbox" name="hydroclim-stas" disabled value="Variance "/> Variance </h4>
                </div></span>
      </div>
    </div>
  </div>
</div>

      <div class="row">
            <div class="col-md-2 col-xs-2 col1 center-block">
             <button id="submit-button" type="submit" class="btn btn-success"> Download your data!</button>
            </div>
      </div>
   </div>
</form>
        </div>
<!--	  <div id="loading">-->
<!--		<div id="loading_anim">The data is downloading, it will take a few minutes...</div></div>-->
<!--			-->
<!--	  </div>-->
    </div>
  </div>
  <div class="section-5-copy">
    <div class="w-layout-grid footer">
      <!-- <a href="https://webflow.com/" target="_blank" class="made-with-webflow w-inline-block"> -->
        <p class="paragraph">@2017</p>
        <!-- <div class="div-block"><img src="images/ezgif.com-webp-to-png-2.png" alt=""><img src="images/ezgif.com-webp-to-png-1.png" width="20" alt=""><img src="images/ezgif.com-webp-to-png.png" alt=""></div> -->
      <!-- </a> -->
    </div>
  </div>
  <script src="https://d1tdp7z6w94jbb.cloudfront.net/js/jquery-3.3.1.min.js" type="text/javascript" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
  <script src="js/webflow.js" type="text/javascript"></script>
<!--  <script src="lib/leaflet/leaflet.js"></script>-->
<!--  <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet-ajax/2.1.0/leaflet.ajax.js"></script>-->
<!--  <script src="lib/leaflet-tilelayer-wmts.js"></script>-->
<!--  <script src="lib/L.Control.MousePosition.js"></script>-->
<!--  <script src="lib/L.Control.ZoomDisplay.js"></script>-->
<!--  <script src="https://unpkg.com/esri-leaflet@3.0.4/dist/esri-leaflet.js"></script>-->
<!--  <script src="lib/Leaflet.GoogleMutant.js"></script>-->
<!--  <script src="lib/Leaflet.fullscreen.min.js"></script>-->
   <script src="lib/jquery-3.2.1.min.js"></script>
<!--  <script src="js/BetterWMS.js"></script>-->
    <!--<script src="lib/jquery-ui.js"></script>-->
	 <script type="text/javascript">
         $(function () {
            $('[data-toggle="tooltip"]').tooltip()
         })
	if(localStorage['Token']){
        $("#login_nav").hide();
        $("#user_nav").text("Hello! " + localStorage['username']).show()
        $("#top_nav").append("<a href='data.html' onclick='logoff();' data-w-id='7a0fcfca-4366-6300-f19e-a21a3ae03d33' class='navigation-item w-nav-link w--current'>LOG OFF</a>")
        function logoff(){
            localStorage.clear();
            $("#login_nav").show();
            $("#user_nav").text("").hide();
        }
    }
    else{
        window.location.href="data_login.html"
    }

    /* Set up basin map for basin selection*/

         var wms_url = "https://www.hydroclim.org/geoserver/wms?";
    /*openlayer*/
         const wmsSource = new ol.source.TileWMS({
             url: wms_url,
             params: {'LAYERS': 'hydroclim:BasinsV2', 'TILED': true},
             serverType: 'geoserver',
             crossOrigin: 'anonymous',
         });

         const wmsLayer = new ol.layer.Tile({
             source: wmsSource,
         });

         const view = new ol.View({
             center: [-12832614.489654021, 6847289.904484687],
             zoom: 3,
         });

         const vectorSource = new ol.source.Vector({

         })
         //
         const styles = {
             'MultiPolygon' : new ol.style.Style({
                 fill: new ol.style.Fill({
                     color:'blue',
                     opacity: 0.7,
                 }),
                 stroke: new ol.style.Stroke({
                     color:'white',
                     width:'2',
                     opacity: 1,
                 })
             })
         }
         const styleFunction = function(feature) {
             return styles[feature.getGeometry().getType()];
         };


         const vectorLayer = new ol.layer.Vector({
             source: vectorSource,
             style: styleFunction
         });



         const map = new ol.Map({
             layers: [
                 new ol.layer.Tile({
                     source: new ol.source.OSM()
                 }),
                 wmsLayer,
                 vectorLayer
             ],
             controls: ol.control.defaults({attribution: false}),
             target: 'basin-map',
             view: view,
         });


         map.on('singleclick', function (evt) {
             //document.getElementById('info').innerHTML = '';
             const viewResolution = /** @type {number} */ (view.getResolution());
             const url = wmsSource.getGetFeatureInfoUrl(
                 evt.coordinate,
                 viewResolution,
                 'EPSG:3857',
                 {'INFO_FORMAT': 'application/json'}
             );
             if (url) {
                 fetch(url)
                     .then((response) => response.text())
                     .then((geoJson) => {
                         const parsedJson = JSON.parse(geoJson)
                         if(parsedJson.hasOwnProperty("numberReturned") && parsedJson["numberReturned"] > 0){
                             vectorSource.clear()
                             vectorLayer.getSource().addFeatures((new ol.format.GeoJSON()).readFeatures(geoJson))
                             $('#basin-data').selectpicker('val', parsedJson.features[0].properties.basin_id);
                         }
                     });
             }
         });
    function getFeature(basin){
        var featureRequest = new ol.format.WFS().writeGetFeature({
            srsName: 'EPSG:3857',
            outputFormat: 'application/json',
            featurePrefix:'hydroclim',
            featureTypes: ['BasinsV2'],
            filter: ol.format.filter.equalTo('basin_id', basin
            )
        });

        // then post the request and add the received features to a layer
        fetch('https://www.hydroclim.org/geoserver/wfs?', {
            method: 'POST',
            body: new XMLSerializer().serializeToString(featureRequest)
        }).then(function(response) {
            return response.json();
        }).then(function(json) {
            var features = new ol.format.GeoJSON().readFeatures(json);
            vectorSource.clear();
            vectorSource.addFeatures(features);
            map.getView().fit(vectorSource.getExtent());
        });
    }


    /* Set the width of the sidebar to 250px and the left margin of the page content to 250px */
    function openNav() {
      $("#mySidebar").width(300);
      refreshQueue()
      //document.getElementById("main").style.marginLeft = "250px";
    }

    /* Set the width of the sidebar to 0 and the left margin of the page content to 0 */
    function closeNav() {
      $("#mySidebar").width(0);
      refreshQueue();
      //document.getElementById("main").style.marginLeft = "0";
    }
    /* initial queue load*/
         var api_url ='http://127.0.0.1:5000/'
    refreshQueue()
    function refreshQueue(){
        $.ajax({
				   type: "GET",
				   url: 'http://127.0.0.1:5000/v1/records/queries',
                   headers:{
				       "x-access-token": localStorage['Token']
                   },
                   beforeSend:function(){
                         $("#mySidebar ul").empty()
                   },
				   success: function(result)
				   {
                        $.each(result, function(index) {
                            var download_html = ""
                            if(result[index]["status"] == 'SUCCESS'){
                                download_html = '<a href="https://www.hydroclim.org/api/v1/records/zip/'+result[index]["file_name"]+ '" >download</a>'
                            }
                            var basin_names = ""
                            var timerangetype = ""
                            var yearstart = ""
                            var yearend = ""
                            var monthstart = ""
                            var monthend = ""
                            if(result[index].hasOwnProperty("arguments") && result[index]["arguments"]!== null) {
                                if (result[index]["arguments"].hasOwnProperty("basin_names")) {
                                    basin_names = result[index]["arguments"]["basin_names"]
                                }
                                if (result[index]["arguments"].hasOwnProperty("timerangetype")) {
                                    timerangetype = result[index]["arguments"]["timerangetype"]
                                }if (result[index]["arguments"].hasOwnProperty("yearstart")) {
                                    yearstart = result[index]["arguments"]["yearstart"]
                                }if (result[index]["arguments"].hasOwnProperty("yearend")) {
                                    yearend = result[index]["arguments"]["yearend"]
                                }if (result[index]["arguments"].hasOwnProperty("monthstart")) {
                                    monthstart = result[index]["arguments"]["monthstart"]
                                }if (result[index]["arguments"].hasOwnProperty("monthend")) {
                                    monthend = result[index]["arguments"]["monthend"]
                                }
                            }
                            var status_style = (result[index]["status"] == 'SUCCESS')?"<span style='color: #3c763d'>":"<span style='color: red'>"
                            var li_item = '<li id=li-' + result[index]['id'] + ' class="list-group-item list-group-item-action flex-column align-items-star">\n' +
                                '                     <div class="d-flex w-100 justify-content-between">\n' +
                                '                         <h5 class="mb-1"><b>Time: </b>'+ toLocal(result[index]["create_time"]).toLocaleString() +'</h5>\n' +
                                '                     </div>\n' +
                                '                    <p class="mb-1"><b>Status: </b> ' + status_style + result[index]["status"] + "</span>" + download_html +
                                '                </p>' +
                                // '                    <h5 class="mb-1"><b>Parameters: </b>' + result[index]["arguments"]["basin_names"] +'</h5>\n' +
                            '<div class="parameter-panel panel-group" id="accordion-parameters-' +  result[index]['id'] + '">\n' +
                            '    <div class="panel panel-default">\n' +
                            '        <div class="panel-heading">\n' +
                            '            <h4 class="panel-title">\n' +
                            '                <a id="heading-' +  result[index]['id'] + '" class="accordion-toggle" aria-controls="task-' +  result[index]['id'] + '-collapse" data-target="#task-' +  result[index]['id'] + '-collapse"  data-toggle="collapse" data-parent="#accordion-parameters-' +  result[index]['id'] + '" href="#">\n' +
                            '                    Parameters\n' +
                            '                </a>\n' +
                            '            </h4>\n' +
                            '        </div>\n' +
                            '        <div aria-labelledby="heading-' +  result[index]['id'] + '" id="task-' +  result[index]['id'] + '-collapse" class="panel-collapse collapse">\n' +
                            '            <div class="panel-body">\n' +
                            '               <div class="row">\n' +
                                '                    <div class="col-sm-12"><b>Basin name</b></div>' +
                                '           </div>' +
                                '            <div class="row">\n' +
                                '                    <div  class="col-sm-12">' + basin_names +'</div>\n' +
                                '           </div>' +
                                '            <div class="row">\n' +
                                '                    <div class="col-sm-8"><b>Date Range Type</b></div>' +
                                '           </div>' +
                                '            <div class="row">\n' +
                                '                    <div  class="col-sm-4">' + timerangetype +'</div>\n' +
                                '           </div>' +

                                '            <div class="row">\n' +
                                '                    <div class="col-sm-4"><b>Year</b></div>' +
                                '                    <div  class="col-sm-8">From ' + yearstart +' to  ' +yearend + '</div>\n' +
                                '           </div>' +
                                '            <div class="row">\n' +
                                '                    <div class="col-sm-4"><b>Month</b></div>' +
                                '                    <div  class="col-sm-8">From' +monthstart +' to  ' +monthend + '</div>\n' +
                                '           </div>' +
                            '            </div>\n' +
                            '        </div>\n' +
                            '    </div>\n' +
                            '</div>'
                            '         +  </li>'

                            $("#mySidebar ul").append(li_item)
                            if(!result[index]["checked_flag"]){
                                 $("#li-" +result[index]['id']).css("background-color","#fff0e0")
                            }
                            $(document).on('click', "#li-"+ result[index]['id'] , function() {
                                updateUnChecked(result[index]['id'])
                            });
                        });

				   },
                    error: function (xhr, ajaxOptions, thrownError) {
                        Snackbar.show({
										text: "Can not load the queue.Sorry, something went wrong. <br>Error code:" + xhr.status + '-' + thrownError,
										pos:'bottom-center'
									});
                        if(parseInt(xhr.status) == '401'){
										window.location.href="data_login.html"
									}

                    }

				 });
    }

    //var api_url ='https://www.hydroclim.org/api/'
    var currentNewCompleteNumber = 0;
    getUncheckedNumber()
    setInterval(getUncheckedNumber, 5000);//time in milliseconds
    function getUncheckedNumber() {
        $.ajax({
				   type: "GET",
				   url: 'http://127.0.0.1:5000/v1/records/unchecked',
                   headers:{
				       "x-access-token": localStorage['Token']
                   },
				   success: function(result)
				   {
				       unchecked_number = result["unchecked_number"]
                       if(unchecked_number > 0){
                           $("#badge").show()
                           $("#badge").text(unchecked_number)
                           // console.log(unchecked_number)
                           if(unchecked_number>currentNewCompleteNumber){
                                Snackbar.show({
										text: 'New query completed!',
										pos:'bottom-center'
									});
                   refreshQueue()
                           }
                       }
                       else{
                           $("#badge").hide()
                           $("#badge").text(unchecked_number)
                       }
                       currentNewCompleteNumber = unchecked_number
				   },
                    error: function (xhr, ajaxOptions, thrownError) {
                        console.log("Error:" +  xhr.status + " - " + thrownError)
                        if(parseInt(xhr.status) == '401'){
										window.location.href="data_login.html"
									}

                    }
				 });
    }
    function updateUnChecked(id) {
        $.ajax({
				   type: "GET",
				   url: 'http://127.0.0.1:5000/v1/records/updateunchecked/' + id,
				   success: function(result)
				   {
				       $("#li-" +id).css("background-color","")
                       getUncheckedNumber()
				   },
                    error: function (xhr, ajaxOptions, thrownError) {
                        console.log("Error:" +  xhr.status + " - " + thrownError)
                        if(parseInt(xhr.status) == '401'){
                            window.location.href="data_login.html"
									}
                    }
				 });
    }


</script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.3/umd/popper.min.js"></script>
    <script src="lib/bootstrap/js/bootstrap.min.js"></script>
    <script src="js/utils.js"></script>
    <script src="js/data.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap-select@1.13.10/dist/js/bootstrap-select.min.js"></script>
    <script type="module" src="https://spin.js.org/spin.js"></script>
	<script src="js/validation.js"></script>
    <script src="js/downloads.js"></script>
  <!-- [if lte IE 9]><script src="https://cdnjs.cloudflare.com/ajax/libs/placeholders/3.0.2/placeholders.min.js"></script><![endif] -->
</body>
</html>